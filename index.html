<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Automatic Happiness Meter</title>
    <script src="https://cdn.jsdelivr.net/npm/@vladmandic/face-api/dist/face-api.js"></script>
    <style>
        body { 
            font-family: 'Segoe UI', sans-serif; 
            text-align: center; 
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d); 
            color: white; 
            margin: 0; 
            padding: 20px; 
            overflow: hidden;
        }
        .container { 
            background: rgba(255, 255, 255, 0.15); 
            padding: 20px; 
            border-radius: 25px; 
            backdrop-filter: blur(10px); 
            max-width: 400px; 
            margin: auto;
            border: 1px solid rgba(255,255,255,0.2);
        }
        #video { 
            border-radius: 15px; 
            width: 100%; 
            transform: scaleX(-1); 
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            margin-top: 10px;
        }
        #score-display { 
            font-size: 5rem; 
            font-weight: 900; 
            margin: 5px 0; 
        }
        #hindi-quote { 
            font-size: 1.2rem; 
            min-height: 50px; 
            color: #fff; 
            background: rgba(0,0,0,0.2);
            padding: 10px;
            border-radius: 10px;
            margin-bottom: 10px;
        }
        .beauty-btn {
            background: #ff6b81;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
        }
    </style>
</head>
<body onload="initApp()">

    <div class="container">
        <h2 id="greeting">‡§®‡§Æ‡§∏‡•ç‡§§‡•á</h2>
        <div id="score-display">--</div>
        <div id="hindi-quote">AI Loading... Please wait</div>
        
        <video id="video" autoplay muted playsinline></video>
        
        <button class="beauty-btn" onclick="alert('AI Analysis: ‡§Ü‡§™ ‡§Ü‡§ú 100% ‡§∏‡•Å‡§Ç‡§¶‡§∞ ‡§≤‡§ó ‡§∞‡§π‡•á ‡§π‡•à‡§Ç! ‚ú®')">‚ú® Beauty Index</button>
    </div>

    <script>
        const video = document.getElementById('video');
        const scoreDiv = document.getElementById('score-display');
        const quoteDiv = document.getElementById('hindi-quote');
        const greetingDiv = document.getElementById('greeting');

        // Automatic Greeting
        const hour = new Date().getHours();
        if (hour < 12) greetingDiv.innerText = "Good Morning! ‚òÄÔ∏è";
        else if (hour < 17) greetingDiv.innerText = "Good Afternoon! ‚òï";
        else greetingDiv.innerText = "Good Evening! üåô";

        async function initApp() {
            try {
                // 1. Load AI Models Automatically
                await faceapi.nets.tinyFaceDetector.loadFromUri('https://cdn.jsdelivr.net/npm/@vladmandic/face-api/model/');
                await faceapi.nets.faceExpressionNet.loadFromUri('https://cdn.jsdelivr.net/npm/@vladmandic/face-api/model/');

                // 2. Request Camera Automatically
                const stream = await navigator.mediaDevices.getUserMedia({ video: {} });
                video.srcObject = stream;
                
                quoteDiv.innerText = "Ready! Smile please üòä";
                runDetection();
            } catch (err) {
                quoteDiv.innerText = "Please allow camera access!";
                console.error(err);
            }
        }

        async function runDetection() {
            const detections = await faceapi.detectAllFaces(video, new faceapi.TinyFaceDetectorOptions()).withFaceExpressions();
            
            if (detections.length > 0) {
                const happyScore = detections[0].expressions.happy;
                const percent = Math.round(happyScore * 100);
                
                scoreDiv.innerText = percent + "%";
                
                if (percent < 30) {
                    quoteDiv.innerText = "‡§Æ‡•Å‡§∏‡•ç‡§ï‡•Å‡§∞‡§æ‡§á‡§è, ‡§Ü‡§™ ‡§¨‡§π‡•Å‡§§ ‡§∏‡•Å‡§Ç‡§¶‡§∞ ‡§π‡•à‡§Ç! üòä";
                    scoreDiv.style.color = "#ff6b6b";
                } else if (percent < 70) {
                    quoteDiv.innerText = "Good! ‡§Ü‡§™‡§ï‡•Ä ‡§Æ‡•Å‡§∏‡•ç‡§ï‡§æ‡§® ‡§¨‡§¢‡§º ‡§∞‡§π‡•Ä ‡§π‡•à‡•§ ‚ú®";
                    scoreDiv.style.color = "#ffd93d";
                } else {
                    quoteDiv.innerText = "‡§∂‡§æ‡§®‡§¶‡§æ‡§∞! ‡§Ü‡§™‡§ï‡•Ä ‡§ñ‡•Å‡§∂‡•Ä ‡§Ö‡§®‡§Æ‡•ã‡§≤ ‡§π‡•à‡•§ üòç";
                    scoreDiv.style.color = "#4ef3e1";
                }
            }
            requestAnimationFrame(runDetection);
        }
    </script>
</body>
</html>
